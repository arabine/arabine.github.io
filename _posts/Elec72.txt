(((Magazine : PC Team 72)))
(((Rubrique : Team pratik)))
(((Sous Rubrique : électronique)))

(((titre))) Un oscilloscope numérique sur PC

(((chapo)))
Un oscilloscope est un appareil de mesure très onéreux et pourtant extrêmement utile pour l'électronicien. Nous allons construire le notre, certes limité mais qui nous donnera l'occasion de parler de la conversion analogique/numérique.

(((texte)))
L'oscilloscope est un appareil de mesure qui permet de visualiser l'évolution d'une tension en fonction du temps. Il devient indispensable lorsqu'il s'agit de visualiser un dialogue entre plusieurs composants, ou l'évolution d'un courant à travers une charge. L'oscilloscope classique se présente sous la forme d'un écran cathodique et une dizaine de boutons de réglage en façade. Le principe de fonctionnement est simple : un canon à électron projette un faisceau lumineux sur un écran fluorescent. Celui ci se matérialise par ce que l'on appelle le spot. Deux plaques verticales situées à gauche et à droite de ce faisceau se chargent de déplacer horizontalement le spot :  c'est le défilement, qui peut être modifiée à loisir par l'utilisateur. Enfin, deux autres plaques horizontales situées eu dessus et en dessous du faisceau ont pour but de faire varier le spot verticalement, en fonction de la différence de potentiel mesurée. Evidemment , une foule de réglages supplémentaires viennent se greffer tout autour pour régler précisément le signal. Depuis quelques années, on voit apparaître les oscilloscopes numériques. Ils possèdent de nombreux avantages et deviennent même indispensables lorsqu'il s'agit de visualiser un protocole  ou des informations nécessitant une mise en mémoire. Malheureusement, un tel appareil coûte assez cher. Qu'à cela ne tienne, nous allons construire le notre, très simplifié bien sûr. Il se matérialisera par une petite interface électronique qui nous permettra de visualiser une courbe sur l'écran du PC.

(((inter))) La conversion analogique/numérique
Souvent appelée CAN (ou Analog-to-Digital Conversion en anglais), cette transformation est nécessaire pour changer le support de l'information. En effet, la donnée que nous allons visualiser sera sous forme analogique, c'est à dire une tension dont l'amplitude peut prendre une infinité de valeurs et est variable plus ou moins rapidement selon le temps. Or, comme chacun sait, l'ordinateur ne comprends que les 0 et les 1, le binaire, qui se traduit le plus souvent par une tension de 5V pour représenter un 1 et une tension de 0V pour représenter le 0. Heureusement pour nous, il existe des composants intégrés réalisant tout ce travail de transformation à notre place. Plusieurs technologies existent pour mener à bien cette conversions. Convertisseurs à simples et double rampe, qui sont de fabrications très simples mais assez lentes. Les techniques les plus rapides font appelles au principe de réaction ou aux approximations successives. Ce dernier type de convertisseur est le plus répandu. Son principe se base sur la dichotomie : la grandeur analogique est comparée successivement aux réponses numériques possibles, jusqu'à atteindre la valeur la plus proche. C'est en quelque sorte le jeu du "devinez un nombre entre un et cent". L'avantage ce cette méthode est que le temps de conversion est constant quel que soit la grandeur d'entrée : le résultat est obtenu en n comparaisons si le convertisseur possède une résolution de n bits. Enfin, les derniers types de convertisseurs, appelés "parallèles", sont très rapides et trouvent leur utilité dans l'imagerie ou les transmissions radar par exemple. Bien évidemment, la conversion analogique/numérique ne se fait pas sans erreurs, ce n'est une quantification numérique approchée de la réalité (on parle alors d'erreur de linéarité, d'offset et de gain).

(((inter))) Choix d'un convertisseur
Voilà le moment de faire le choix d'un convertisseur adapté à notre utilisation. On peut être facilement désorienté devant la quantité astronomique de composants existants dans les catalogues. Cependant, il est possible de choisir rapidement le bon convertisseur par ses quelques caractéristiques. D'une part, sachez que plus le convertisseur sera rapide et précis, plus il coûtera cher, et les prix peuvent devenir rapidement astronomiques. Un premier paramètre est le protocole de dialogue avec le composant. Il peut être série, généralement trois fils suffisent, ou parallèle, la taille du bus de données étant en fonction de la résolution du convertisseur. Parlons un peu de cette résolution, qui à elle seule fixe le prix d'un composant. La résolution est le nombre de bits sur lesquels la donnée numérisée sera codée. Par exemple, si l'on possède un convertisseur 8 bits avec une tension de référence de 5V, la sensibilité sera de 5/256 =  0,01953125 V par LSB (Least Significant Bit). Un convertisseur de 8 bits sera suffisant pour de petites applications nécessitant peu de résolutions, comme un voltmètre par exemple, et peuvent se trouver facilement pour quelques dizaines de francs. Les versions 10 et 12 bits se montreront beaucoup plus précis, mais il faudra alors compter aux alentours de cent francs. Pensez cependant que la résolution ne fait pas toute la qualité du circuit car la simple variation de l'alimentation peut rendre les résultats d'un convertisseur complètement aberrants, même s'il est de très grande résolution. Enfin, d'autres critères peuvent être pris en compte comme le nombre de voies, la taille du boîtier ou la consommation.

(((inter))) Le montage
Un oscilloscope est en réalité un voltmètre et partant ne doit pas perturber le fonctionnement du montage où il vient visualiser les grandeurs électriques. Pour cela, nous lui adjoignons un amplificateur opérationnel monté en suiveur : comme il possède une forte impédance d'entrée (de l'ordre du mégohms), il ne causera aucun tord à l'électronique. Bien sûr, pour ne pas brider les performances du CAN, il faut bien choisir l'amplificateur opérationnel. Il faut veillez à ce que celui-ci possède un bon slew-rate, c'est à dire qu'il soit rapide. Nous l'alimentons en 5V ce qui limitera la visualisation des tensions à cette plage. En ce qui concerne le CAN, le composant que nous utilisons ici est le ADC0831. C'est un convertisseur 8 bits avec accès série, le tout empaqueté dans un petit boîtier DIL de 8 broches. Le câblage d'un tel composant est simple, il faut bien sûr prendre soin de relier convenablement la broche de voltage de référence. Généralement, celle-ci possède le même potentiel que l'alimentation du composant. L'alimentation peut être externe, issue d'un régulateur de tension comme le fameux 7805. Enfin, le tout est relié au PC via le port parallèle pour dialoguer avec le composant. Point de composants supplémentaires car le port parallèle est TTL.

(((inter))) La programmation
L'algorithme principal est la lecture de la donnée numérisée. Pour cela, il faut se reporter au datasheet de votre composant. Vous y trouverez les chronogrammes de lecture (ou d'écriture dans le cas d'un choix d'une voie de multiplexage) ainsi que toutes les caractéristiques de votre convertisseur. La caractéristique essentielle est le temps de conversion qui permet de déterminer la limite d'échantillonnage du système. Pour le ADC0831, ce temps est de 32µs, soit 31,25 KHz. Or, pour récupérer un signal en entier, le théorème de Shannon dit qu'il faut échantillonner à au moins deux fois la fréquence maximale. Dans la pratique, il faut compter un facteur d'au moins 10, ce qui limite notre système à une fréquence d'entrée d'environ 3 KHz pour espérer obtenir une trace convenable. Bien sûr, l'ordinateur n'est pas la plate-forme idéale pour une telle application, car d'autres problèmes viennent se greffer comme le multitâches du système d'exploitation. Une solution étant de passer sous le vrai mode DOS par exemple. N'hésitez pas à consulter les sources de notre programme d'exmple, TeamScope, qui offre une bonne base de départ.

(((inter))) Conclusion
Notre montage est très basic mais suffisamment didactique pour comprendre de nombreux phénomènes Le montage électronique peuvent être améliorer. Il serait bon par exemple de placer un condensateur commutable à l'entrée (100nF) pour choisir entre les modes AC et DC. Au niveau de l'AOP, il peut être intéressant de choisir une alimentation symétrique +5/-5V pour avoir une plage plus grande et pour visualiser les tensions alternatives. Il existe quelques convertisseurs DC/DC comme le MAX828 qui permettent d'obtenir du –5V à partir du +5V. Enfin, une attention un peu plus grande peut être apportée à la tension de référence pour qu'elle ne soit moins sujette aux perturbations de l'alimentation. Voilà de quoi vous occuper !

(((signature)))
Anthony Rabine - arabine@programmationworld.com

(((images)))
elec1.tif : Notre oscilloscope rudimentaire.
elec2.tif : Le convertisseur analogique numérique est le cœur du montage.
elec3.tif : Principe de la conversion par approximations successives.
elec4.tif : Les datasheets fournissent tous les chronogrammes pour construire vos algorithmes.
